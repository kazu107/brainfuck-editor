<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Brainfuck Runner</title>

    <!-- CodeMirror core + theme / Brainfuck mode -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/theme/dracula.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/brainfuck/brainfuck.min.js"></script>
</head>
<body>
<div id="app">
    <div class="left-panel">
        <h1>Brainfuck Runner</h1>

        <section class="memory-section">
            <div class="section-header-row">
                <div class="editor-header-left">
                    <h2>Memory Viewer</h2>
                    <div class="memory-header-right">
                        <span>Format:</span>
                        <button id="memory-format-toggle" type="button" class="toggle-pill active">Hex</button>
                    </div>
                </div>
                <small>Columns: 0-F / Rows: 00-FF (4096 bytes)</small>
            </div>
            <div class="memory-container">
                <table id="memory-table"></table>
            </div>
            <p class="memory-caption">Columns use low 4 bits (0-F); rows use high 8 bits (00-FF).</p>
        </section>

        <section class="controls-section">
            <h2>Execution Settings</h2>
            <div class="settings">
                <h3>Settings</h3>
                <label for="eof-behavior">EOF behavior (when ',' runs out of input)</label>
                <select id="eof-behavior">
                    <option value="unchanged">Leave cell unchanged</option>
                    <option value="zero">Write 0</option>
                    <option value="minusOne">Write 255 (0xFF)</option>
                </select>

                <label for="max-steps">Max steps (infinite loop guard)</label>
                <input id="max-steps" type="number" value="1000000" min="1" step="1000" />

                <label for="execution-speed">Execution speed (ms between steps)</label>
                <input id="execution-speed" type="number" value="10" min="0" step="5" />

                <label class="checkbox-row">
                    <input id="instant-run" type="checkbox" />
                    Run instantly (override delay)
                </label>
            </div>
        </section>

        <section class="ascii-section">
            <h2>ASCII Cheat Sheet</h2>
            <div class="ascii-container">
                <table id="ascii-table">
                    <thead>
                    <tr>
                        <th>Dec</th>
                        <th>Hex</th>
                        <th>Char</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>
    </div>

    <div class="right-panel">
        <section class="editor-section">
            <div class="section-header-row">
                <div class="editor-header-left">
                    <h2>Code Editor</h2>
                    <div class="editor-tabs-wrapper">
                        <div class="editor-tabs" id="editor-tabs"></div>
                        <button id="add-tab-btn" type="button" class="icon-button tab-add" title="Add new tab">
                            <svg width="14" height="14" viewBox="0 0 14 14" aria-hidden="true">
                                <path d="M7 2v10M2 7h10" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="editor-header-right">
                    <div class="editor-actions">
                        <button id="run-btn" type="button" class="icon-button" title="Run to completion (resets state)">
                            <svg width="14" height="14" viewBox="0 0 14 14" aria-hidden="true">
                                <path d="M3 2.5v9l8-4.5-8-4.5z" fill="currentColor"/>
                            </svg>
                        </button>
                        <button id="step-btn" type="button" class="icon-button" title="Step once (runs grouped + or - together)">
                            <svg width="14" height="14" viewBox="0 0 14 14" aria-hidden="true">
                                <path d="M3 3h2v8H3V3zm3 0l5 4-5 4V3z" fill="currentColor"/>
                            </svg>
                        </button>
                        <button id="reset-btn" type="button" class="icon-button" title="Reset memory, output, and state">
                            <svg width="14" height="14" viewBox="0 0 14 14" aria-hidden="true">
                                <path d="M7 2a5 5 0 00-4.58 3H1l2 2 2-2H3.1A4 4 0 117 11a4 4 0 01-3.44-2H2.3A5 5 0 107 2z" fill="currentColor"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <!-- textarea is replaced via CodeMirror.fromTextArea -->
            <textarea id="code" spellcheck="false"></textarea>
        </section>

        <section class="io-section">
            <div class="io-block">
                <h2>Input (stdin)</h2>
                <textarea id="input" placeholder="Text consumed by ',' goes here"></textarea>
            </div>
            <div class="io-block">
                <h2>Output (stdout)</h2>
                <pre id="output"></pre>
            </div>
        </section>
    </div>
</div>

<script src="main.js"></script>
</body>
</html>
